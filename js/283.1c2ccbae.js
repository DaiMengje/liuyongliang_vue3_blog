"use strict";(self["webpackChunkvue_admin"]=self["webpackChunkvue_admin"]||[]).push([[283],{7644:function(t,e,a){a.d(e,{Z:function(){return L}});var n=a(7462),o=a(3396),r=a(1413),i=a(4942),s=a(9242),l=a(7495),c=a(252),u=a(5802);function d(){var t=[].slice.call(arguments,0);return 1===t.length?t[0]:function(){for(var e=0;e<t.length;e++)t[e]&&t[e].apply&&t[e].apply(this,arguments)}}var m={mixins:[u.Z],props:{duration:l.Z.number.def(1.5),closable:l.Z.looseBool,prefixCls:l.Z.string,update:l.Z.looseBool,closeIcon:l.Z.any,onClose:l.Z.func},watch:{duration:function(){this.restartCloseTimer()}},mounted:function(){this.startCloseTimer()},updated:function(){this.update&&this.restartCloseTimer()},beforeUnmount:function(){this.clearCloseTimer(),this.willDestroy=!0},methods:{close:function(t){t&&t.stopPropagation(),this.clearCloseTimer(),this.__emit("close")},startCloseTimer:function(){var t=this;this.clearCloseTimer(),!this.willDestroy&&this.duration&&(this.closeTimer=setTimeout((function(){t.close()}),1e3*this.duration))},clearCloseTimer:function(){this.closeTimer&&(clearTimeout(this.closeTimer),this.closeTimer=null)},restartCloseTimer:function(){this.clearCloseTimer(),this.startCloseTimer()}},render:function(){var t,e=this.prefixCls,a=this.closable,n=this.clearCloseTimer,r=this.startCloseTimer,s=this.close,l=this.$attrs,u="".concat(e,"-notice"),d=(t={},(0,i.Z)(t,"".concat(u),1),(0,i.Z)(t,"".concat(u,"-closable"),a),t),m=(0,c.Xr)(this,"closeIcon");return(0,o.Wm)("div",{class:d,style:l.style||{right:"50%"},onMouseenter:n,onMouseleave:r},[(0,o.Wm)("div",{class:"".concat(u,"-content")},[(0,c.z9)(this)]),a?(0,o.Wm)("a",{tabindex:"0",onClick:s,class:"".concat(u,"-close")},[m||(0,o.Wm)("span",{class:"".concat(u,"-close-x")},null)]):null])}},p=a(7129),f=function(t,e){var a={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(a[n]=t[n]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(a[n[o]]=t[n[o]])}return a};function y(){}var v=0,h=Date.now();function g(){return"rcNotification_".concat(h,"_").concat(v++)}var C=(0,o.aZ)({mixins:[u.Z],props:{prefixCls:l.Z.string.def("rc-notification"),transitionName:l.Z.string,animation:l.Z.oneOfType([l.Z.string,l.Z.object]).def("fade"),maxCount:l.Z.number,closeIcon:l.Z.any},data:function(){return{notices:[]}},methods:{getTransitionName:function(){var t=this.$props,e=t.transitionName;return!e&&t.animation&&(e="".concat(t.prefixCls,"-").concat(t.animation)),e},add:function(t){var e=t.key=t.key||g(),a=this.$props.maxCount;this.setState((function(n){var o=n.notices,r=o.map((function(t){return t.key})).indexOf(e),i=o.concat();return-1!==r?i.splice(r,1,t):(a&&o.length>=a&&(t.updateKey=i[0].updateKey||i[0].key,i.shift()),i.push(t)),{notices:i}}))},remove:function(t){this.setState((function(e){return{notices:e.notices.filter((function(e){return e.key!==t}))}}))}},render:function(){var t=this,e=this.prefixCls,a=this.notices,n=this.remove,s=this.getTransitionName,l=this.$attrs,u=(0,p.Mz)(s()),f=a.map((function(r,i){var s=Boolean(i===a.length-1&&r.updateKey),l=r.updateKey?r.updateKey:r.key,u=r.content,p=r.duration,f=r.closable,v=r.onClose,h=r.style,g=r.class,C=d(n.bind(t,r.key),v),_={prefixCls:e,duration:p,closable:f,update:s,closeIcon:(0,c.Xr)(t,"closeIcon"),onClose:C,onClick:r.onClick||y,style:h,class:g,key:l};return(0,o.Wm)(m,_,{default:function(){return["function"===typeof u?u():u]}})})),v=(0,i.Z)({},e,1);return(0,o.Wm)("div",{class:v,style:l.style||{top:"65px",left:"50%"}},[(0,o.Wm)(p.W3,(0,r.Z)({tag:"span"},u),{default:function(){return[f]}})])}});C.newInstance=function(t,e){var a=t||{},r=a.getContainer,i=a.style,l=a.class,c=f(a,["getContainer","style","class"]),u=document.createElement("div");if(r){var d=r();d.appendChild(u)}else document.body.appendChild(u);var m=(0,s.ri)({mounted:function(){var t=this;this.$nextTick((function(){e({notice:function(e){t.$refs.notification.add(e)},removeNotice:function(e){t.$refs.notification.remove(e)},component:t,destroy:function(){m.unmount(u),u.parentNode&&u.parentNode.removeChild(u)}})}))},render:function(){var t=(0,n.Z)((0,n.Z)({},c),{ref:"notification",style:i,class:l});return(0,o.Wm)(C,t,null)}});m.mount(u)};var _,b,w,k=C,Z=k,x=a(2510),W=a(1089),T=a(5956),N=a(2669),O=a(1390),P=3,$=1,S="ant-message",K="move-up",j=function(){return document.body};function H(t){b?t(b):Z.newInstance({prefixCls:S,transitionName:K,style:{top:_},getContainer:j,maxCount:w},(function(e){b?t(b):(b=e,t(e))}))}var U={info:O.Z,success:N.Z,error:T.Z,warning:W.Z,loading:x.Z};function I(t){var e=void 0!==t.duration?t.duration:P,a=U[t.type],n=a?(0,o.Wm)(a,null,null):"",r=t.key||$++,i=new Promise((function(a){var i=function(){return"function"===typeof t.onClose&&t.onClose(),a(!0)};H((function(a){a.notice({key:r,duration:e,style:t.style||{},class:t.class,content:function(){return(0,o.Wm)("div",{class:"".concat(S,"-custom-content").concat(t.type?" ".concat(S,"-").concat(t.type):"")},[t.icon||n,(0,o.Wm)("span",null,[t.content])])},onClose:i})}))})),s=function(){b&&b.removeNotice(r)};return s.then=function(t,e){return i.then(t,e)},s.promise=i,s}function A(t){return"[object Object]"===Object.prototype.toString.call(t)&&!!t.content}var B={open:I,config:function(t){void 0!==t.top&&(_=t.top,b=null),void 0!==t.duration&&(P=t.duration),void 0!==t.prefixCls&&(S=t.prefixCls),void 0!==t.getContainer&&(j=t.getContainer),void 0!==t.transitionName&&(K=t.transitionName,b=null),void 0!==t.maxCount&&(w=t.maxCount,b=null)},destroy:function(){b&&(b.destroy(),b=null)}};["success","info","warning","error","loading"].forEach((function(t){B[t]=function(e,a,o){return A(e)?B.open((0,n.Z)((0,n.Z)({},e),{type:t})):("function"===typeof a&&(o=a,a=void 0),B.open({content:e,duration:a,type:t,onClose:o}))}})),B.warn=B.warning;var L=B},5283:function(t,e,a){a.r(e),a.d(e,{default:function(){return C}});var n=a(3396),o=a(7139);const r={style:{margin:"20px"}},i=(0,n._)("span",null,"选择商品分类:",-1),s=(0,n.Uk)("添加属性"),l=(0,n.Uk)("编辑"),c=(0,n.Uk)("删除"),u=(0,n.Uk)("添加属性"),d=(0,n.Uk)("编辑"),m=(0,n.Uk)("删除");function p(t,e,a,p,f,y){const v=(0,n.up)("a-alert"),h=(0,n.up)("a-cascader"),g=(0,n.up)("a-button"),C=(0,n.up)("a-tag"),_=(0,n.up)("a-table"),b=(0,n.up)("a-tab-pane"),w=(0,n.up)("a-tabs"),k=(0,n.up)("a-input"),Z=(0,n.up)("a-form-item"),x=(0,n.up)("a-form"),W=(0,n.up)("a-modal");return(0,n.wg)(),(0,n.iD)(n.HY,null,[(0,n._)("div",null,[(0,n.Wm)(v,{message:"注意:只允许为三级分类设置相关参数!",type:"warning","show-icon":""})]),(0,n._)("div",r,[i,(0,n.Wm)(h,{options:p.allCateList,"display-render":p.displayRender,"expand-trigger":"hover",placeholder:"请选择分类",fieldNames:{label:"cat_name",value:"cat_id",children:"children"}},null,8,["options","display-render"])]),(0,n._)("div",null,[(0,n.Wm)(w,{activeKey:p.activeKey,"onUpdate:activeKey":e[2]||(e[2]=t=>p.activeKey=t),onChange:p.tabChangeHandler,pagination:!1},{default:(0,n.w5)((()=>[(0,n.Wm)(b,{disabled:p.isNotSelected,key:"many",tab:"动态参数"},{default:(0,n.w5)((()=>[(0,n.Wm)(g,{disabled:p.isNotSelected,type:"primary",style:{"margin-bottom":"20px"},onClick:e[0]||(e[0]=t=>p.showAddParamsBox("many"))},{default:(0,n.w5)((()=>[s])),_:1},8,["disabled"]),0!=p.paramsList.length?((0,n.wg)(),(0,n.j4)(_,{key:0,columns:p.columns,"data-source":p.paramsList,rowKey:"attr_id",bordered:"",pagination:!1},{handler:(0,n.w5)((t=>{let{record:e}=t;return[(0,n.Wm)(g,{type:"primary",size:"small",onClick:t=>p.showAddParamsBox("many",e)},{default:(0,n.w5)((()=>[l])),_:2},1032,["onClick"]),(0,n.Wm)(g,{type:"primary",danger:"",size:"small",onClick:t=>p.deleteManyParams(e.cat_id,e.attr_id)},{default:(0,n.w5)((()=>[c])),_:2},1032,["onClick"])]})),expandedRowRender:(0,n.w5)((t=>{let{record:e}=t;return[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.attr_vals.split(","),((t,e)=>((0,n.wg)(),(0,n.j4)(C,{color:"pink",key:e},{default:(0,n.w5)((()=>[(0,n.Uk)((0,o.zw)(t),1)])),_:2},1024)))),128))]})),_:1},8,["columns","data-source"])):(0,n.kq)("",!0)])),_:1},8,["disabled"]),(0,n.Wm)(b,{disabled:p.isNotSelected,key:"only",tab:"静态属性","force-render":""},{default:(0,n.w5)((()=>[(0,n.Wm)(g,{disabled:p.isNotSelected,type:"primary",style:{"margin-bottom":"20px"},onClick:e[1]||(e[1]=t=>p.showAddParamsBox("only"))},{default:(0,n.w5)((()=>[u])),_:1},8,["disabled"]),0!=p.paramsList.length?((0,n.wg)(),(0,n.j4)(_,{key:0,columns:p.columns,"data-source":p.paramsList,rowKey:"attr_id",bordered:"",pagination:!1},{handler:(0,n.w5)((t=>{let{record:e}=t;return[(0,n.Wm)(g,{type:"primary",size:"small",onClick:t=>p.showAddParamsBox("only",e)},{default:(0,n.w5)((()=>[d])),_:2},1032,["onClick"]),(0,n.Wm)(g,{type:"primary",danger:"",size:"small",onClick:t=>p.deleteManyParams(e.cat_id,e.attr_id)},{default:(0,n.w5)((()=>[m])),_:2},1032,["onClick"])]})),_:1},8,["columns","data-source"])):(0,n.kq)("",!0)])),_:1},8,["disabled"])])),_:1},8,["activeKey","onChange"]),(0,n.Wm)(W,{visible:p.showAddParamsVisible,"onUpdate:visible":e[5]||(e[5]=t=>p.showAddParamsVisible=t),title:"添加参数",onOk:p.addParamsOkHandler},{default:(0,n.w5)((()=>[(0,n.Wm)(x,{model:p.paramsFormState},{default:(0,n.w5)((()=>[(0,n.Wm)(Z,{label:"属性名称"},{default:(0,n.w5)((()=>[(0,n.Wm)(k,{value:p.paramsFormState.attr_name,"onUpdate:value":e[3]||(e[3]=t=>p.paramsFormState.attr_name=t)},null,8,["value"])])),_:1}),(0,n.Wm)(Z,{label:"属性值"},{default:(0,n.w5)((()=>[(0,n.Wm)(k,{value:p.paramsFormState.attr_vals,"onUpdate:value":e[4]||(e[4]=t=>p.paramsFormState.attr_vals=t)},null,8,["value"])])),_:1}),(0,n.Wm)(v,{message:"注意:每一个属性之间请用英文逗号分割 ! ! !",type:"warning","show-icon":""})])),_:1},8,["model"])])),_:1},8,["visible","onOk"])])],64)}var f=a(4870),y=a(7644),v={setup(){const{proxy:t}=(0,n.FN)(),e=(0,f.iH)([]),a={sel:"many"},o=async()=>{const{meta:a,data:n}=await t.$http.get("categories");if(200!=a.status)return y.Z.error(a.msg);e.value=n};(0,n.bv)((()=>{o()}));const r=(0,f.iH)(),i=(0,f.iH)(!0),s=t=>{let{labels:e,selectedOptions:a}=t;return 0!=a.length?(i.value=!1,r.value=a[a.length-1].cat_id,u()):(i.value=!0,c.value=[]),e[e.length-1]},l=(0,f.iH)("many"),c=(0,f.iH)([]),u=async()=>{const{meta:e,data:n}=await t.$http.get(`categories/${r.value}/attributes`,{params:a});if(200!=e.status)return y.Z.error(e.msg);c.value=n},d=t=>{c.value="",a.sel=t,u()},m=[{title:"属性名字",dataIndex:"attr_name"},{title:"属性值",dataIndex:"attr_vals"},{title:"操作",width:"20%",slots:{customRender:"handler"}}],p=(0,f.qj)({attr_name:"",attr_vals:""}),v=(0,f.iH)(!1);let h="many",g="";const C=(t,e)=>{e&&(g=e.attr_id,p.attr_name=e.attr_name,p.attr_vals=e.attr_vals),h=t,v.value=!0},_=async()=>{if(v.value=!1,g){const{meta:e}=await t.$http.put(`categories/${r.value}/attributes/${g}`,{attr_name:p.attr_name,attr_sel:h,attr_vals:p.attr_vals});if(200!=e.status)return y.Z.error(e.msg);y.Z.success(e.msg),u()}else{const{meta:e}=await t.$http.post(`categories/${r.value}/attributes`,{attr_name:p.attr_name,attr_sel:h,attr_vals:p.attr_vals});if(201!=e.status)return y.Z.error(e.msg);y.Z.success(e.msg),u()}p.attr_name="",p.attr_vals=""},b=async(e,a)=>{const{meta:n}=await t.$http.delete(`categories/${e}/attributes/${a}`);if(200!=n.status)return y.Z.error(n.msg);y.Z.success(n.msg),u()};return{showAddParamsVisible:v,paramsFormState:p,deleteManyParams:b,showAddParamsBox:C,addParamsOkHandler:_,displayRender:s,allCateList:e,activeKey:l,columns:m,isNotSelected:i,paramsList:c,tabChangeHandler:d,queryAllCateList:o}}},h=a(89);const g=(0,h.Z)(v,[["render",p]]);var C=g}}]);
//# sourceMappingURL=283.1c2ccbae.js.map